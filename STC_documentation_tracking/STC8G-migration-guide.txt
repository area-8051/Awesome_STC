附录X STC8G 系列单片机取代 STC15 系列的注意事项
Appendix X. STC15 to STC8G migration guide =============================

MCU instructions

The instruction code of STC8G series is exactly the same as that of STC15 
series, so the code of STC15 series is transplanted to STC8G, and the 
operation is still correct, but the instruction speed of STC8G series is 
faster than that of STC15 series, and the instruction system of STC15 
series belongs to STC-Y5 series instructions, while the STC8G series 
instructions belong to the STC-Y6 series instructions, and most of the 
STC-Y6 series instructions only need one CPU clock to execute. If there 
is instruction delay code in the user code, it needs to be adjusted. 

I/O ports

After the STC8G series MCU is powered on, the I/O mode is different from 
that of the STC15 series. All the I/O ports of STC15 series single-chip 
microcomputers are 8051 quasi-bidirectional port mode after power-on, and 
among the I/O ports of STC8G series single-chip microcomputers, except 
for ISP download pin P3.0/P3.1 which is quasi-bidirectional port mode, 
all other All I/O ports are in high-impedance input mode after power-on. 
The traditional 8051 and STC 15 series single-chip microcomputers are in 
the quasi-bidirectional port mode and output high level after power-on. 
There are often customers who use I/O to drive motors or LED lights in 
their systems, so there will be motor failure when the single-chip 
microcomputer is powered on. Move it or the LED will flash once. The I/O 
of the STC8G series is in high-impedance input mode after power-on, which 
can avoid such malfunctions of motors and LEDs.

Because of the I/O of the STC8G series single-chip microcomputer, except 
the ISP download pin P3. Before the I/O port of the STC8G series outputs 
signals to the outside, the working mode of the I/O must be set using 
two registers, PxM0 and PxM1.

Reset pin

The P5.4 port of STC8G series and STC15 series is generally used as an 
ordinary I/O port. When the user sets P5.4 as the reset pin function when 
downloading from ISP, the P5.4 port is the reset pin of the single chip 
microcomputer. 

For STC15H series, the microcontroller is in the reset state when the 
reset pin is high level, and the single chip microcomputer is released 
from the reset state when it is low level. 

The reset level of STC8G series and STC15H series is opposite, that is, 
for STC8G series, when the reset pin is at low level, the microcontroller 
is in the reset state, and when it is at high level, the microcontroller 
is released from the reset state.

Therefore, when the user enables the reset pin function of the P5.4 port, 
it is necessary to pay attention to the problem of the reset level.

ADC

ADC_CONTR, ADC_RES, ADC_RESL3 register addresses of STC8G series and 
STC15 series are the same. But the STC8G series has added two new 
registers: ADCCFG and ADCTIM.

STC15 series start ADC conversion bit ADC_START is located at BIT3 of 
register ADC_CONTR, while STC8G series is located at BIT6 of ADC_CONTR.

The STC15 series ADC conversion completion flag ADC_FLAG is located at 
the BIT4 of the register ADC_CONTR, while the STC8G series is located 
at the BIT5 of the ADC_CONTR.

The ADC speed control of STC15 series is ADC_SPEED located in BIT6-BIT5 
of register ADC_CONTR, while the STC8G series is located in BIT3-BIT0 
of ADCCFG.

The alignment control bit ADRJ of STC15 series ADC conversion result is 
located in BIT5 of register CLK_DIV, while the alignment control bit 
RESFMT of STC8G series is located in BIT5 of ADCCFG.

The STC8G series has added a more precise ADC conversion timing control 
mechanism, which is set through the register ADCTIM.

EEPROM

The waiting time of EEPROM erasing and programming of STC15 series is set 
by Bit2-Bit0 of register IAP_CONTR, which is only an approximate frequency 
range value. STC8G series adds a new register IAP_TPS (SFR address: 0F5H), 
which is specially used to set EEPROM erasing The waiting time for 
division and programming, and the user does not need to calculate, just 
fill in IAP_TPS directly according to the current CPU operating frequency, 
and the hardware will automatically calculate the waiting time. (For 
example: if the current CPU operating frequency is 24MHz, you only need 
to fill in 24 to IAP_TPS)



附录Y STC8G系列单片机取代 STC8A/8F系列的注意事项
Appendix Y. STC8A/8F to STC8G migration guide ==========================

I/O ports

After the STC8G series MCU is powered on, the I/O mode is different from 
that of the STC8A/8F series. All I/O ports of STC8A/8F series single-chip 
microcomputer are 8051 quasi-bidirectional port mode after power-on, and 
among the I/O ports of STC8G series single-chip microcomputer, except ISP 
download pin P3.0/P3.1 is quasi-bidirectional port mode, the rest of the 
I/O ports are in high-impedance input mode after power-on. The traditional 
8051 and STC 15/8A/8F series single-chip microcomputers will be in the 
quasi-bidirectional port mode and output high level after power-on. 
There are often customers who use I/O to drive motors or LED lights in 
their systems, so the power-on of the single-chip microcomputer will 
occur. The moment the motor will move or the LED will flash. The I/O of 
the STC8G series is in high-impedance input mode after power-on, which 
can avoid such malfunctions of motors and LEDs.

Because of the I/O of the STC8G series single-chip microcomputer, except 
the ISP download pin P3. Before the I/O port of the STC8G series outputs 
signals to the outside, the working mode of the I/O must be set using 
two registers, PxM0 and PxM1.

Reset pin

The P5.4 port of STC8G series and STC8A/8F series is generally used as 
an ordinary I/O port. When the user sets P5.4 as the reset pin function 
during ISP downloading, the P5.4 port is the RESET pin. 

For STC8A/8F series, the microcontroller is in the reset state when the 
reset pin is high level, and the single chip microcomputer is released 
from the reset state when it is low level. 

The reset level of STC8G series and STC8A/8F series is opposite, that is, 
for STC8G series, when the reset pin is at low level, the microcontroller 
is in the reset state, and when it is at high level, the microcontroller 
is released from the reset state.

Therefore, when the user enables the reset pin function of the P5.4 port, 
it is necessary to pay attention to the problem of the reset level.

EEPROM

The waiting time of EEPROM erasing and programming of STC8A/8F series is 
set by Bit2-Bit0 of register IAP_CONTR, which is only an approximate 
frequency range value. STC8G series adds a new register IAP_TPS (SFR 
address: 0F5H), which is specially used to set the waiting time for 
EEPROM erasing and programming, and the user does not need to calculate 
it, just fill in IAP_TPS directly according to the current CPU operating 
frequency, and the hardware will automatically calculate the waiting 
time. (For example: if the current CPU operating frequency is 24MHz, 
you only need to fill in 24 to IAP_TPS)
